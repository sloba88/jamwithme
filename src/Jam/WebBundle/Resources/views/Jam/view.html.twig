{% extends '::base.html.twig' %}

{% block body %}

    <h2>{{ 'text.jam.name'|transchoice(jam.name)|desc('Jam name: %jam.name%') }}</h2>

    <div class="col-md-6">

        <h3>{{ 'text.description'|trans }}:</h3>

        <p>{{ jam.description }}</p>

        <h3>{{ 'text.members'|trans }}:</h3>

            {% for m in jam.jamMembers %}
                {% if m.member %}
                <div class="col-md-2 text-center">
                    <a href="{{ path('musician_profile', {'username': m.member.username}) }}">
                        <img src="{{ asset(m.member.images.first.getWebPath|default('/images/placeholder-user.jpg')) | imagine_filter('my_thumb') }}" class="img-circle" />
                        <div>{{ m.member.username }}</div>
                        <div>{{ m.role }}</div>
                    </a>
                </div>
                {% endif %}
            {% endfor %}

        <div class="clearfix"></div>

        <h3>{{ 'text.genres'|trans }}:</h3>

        <ul>
            {% for j in jam.genres %}
                <li>{{ j.name }}</li>
            {% endfor %}
        </ul>

        {% if is_granted("ROLE_USER") %}
            {% if(app.user.isjammember(jam)) %}
            {% else %}
                {% if(app.user.isjammemberRequested(jam)) %}
                    <a href="#">{{ 'text.request.sent'|trans }}</a>
                {% else %}
                    <a href="{{ path('join_jam_request', {'slug': jam.slug}) }}">{{ 'text.join.request'|trans }}</a>
                {% endif %}
            {% endif %}
        {% endif %}
        <br />
        <br />
        {% if is_granted("ROLE_USER") %}
            {% if (app.user.id == jam.creator.id) %}
                <p>{{ 'text.jam.requests'|trans }}:</p>
                <ul>
                    {% for m in jam.memberRequests %}
                        <li>{{ m.username }} <a href="{{ path('jam_accept', {'slug': jam.slug, 'user_id': m.id}) }}">{{ 'text.accept'|trans }}</a> / <a href="">{{ 'text.deny'|trans }}</a></li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endif %}
    </div>

    <div class="col-md-6">

        {% for i in jam.images %}
            <a href="{{ asset(i.getWebPath) | imagine_filter('my_medium') }}"><img src="{{ asset(i.getWebPath|default('/images/placeholder-user.jpg')) | imagine_filter('my_thumb') }}"  /></a>
        {% endfor %}

        {% if is_granted("ROLE_USER") %}
            {% if (app.user.id == jam.creator.id) %}
                <a href="{{ path('edit_jam', { 'slug' : jam.slug } ) }}" class="btn btn-default">{{ 'text.edit'|trans }}</a>
            {% endif %}
        {% endif %}
    </div>

{% endblock %}
