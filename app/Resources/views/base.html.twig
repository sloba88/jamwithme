<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{% block title %}Welcome!{% endblock %}</title>
        <link rel="icon" type="image/x-icon" href="{{ asset('favicon.ico') }}" />

        <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"> -->
        <!-- Bootstrap -->
        <link href="{{ asset('/css/jquery-ui.min.css') }}" rel="stylesheet">
        <link href="{{ asset('/css/chosen.min.css') }}" rel="stylesheet">
        <link href="{{ asset('/css/styles.css') }}" rel="stylesheet">
        <link href="{{ asset('/css/select2.css') }}" rel="stylesheet"/>
        <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

        <style>
            html body #map-canvas {
                height: 600px;
                margin: 0px;
                padding: 0px;
                width: 100%;
                clear: both;
            }
        </style>

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    <script src="https://cdn.socket.io/socket.io-1.0.4.js"></script>
    <script src="{{ node_server }}/socket.io/socket.io.js"></script>

    <script>
        baseURL = '{{ app.request.getBaseURL() }}';
        var socket = io('{{ node_server }}');

        {% if app.user %}
        socket.on('registerConnectedUser', function (data) {
            socket.emit('registerUserData', { userID: '{{ app.user.id }}', 'username': '{{ app.user.username }}' });
        });
        {% endif %}
    </script>

</head>
<body>

<header>
    <div class="container-fluid">

        <div class="row">
            <div class="col-sm-8">
                <div class="navbar-brand">
                    <a href=""><img src="{{ asset('images/logo.png') }}" alt="Logo"></a>
                    <span>. Bringing Musicians Together</span>
                </div>
            </div>

            <div class="col-sm-4">
                <div class="search-block">
                    <button class="btn-search">Search
                        <i class="glyphicon glyphicon-search"></i>
                    </button>
                </div>
            </div>
        </div>

    </div>
</header><!--header ends-->


{#
<!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <a class="navbar-brand" href="{{ path('home') }}"><img src="{{ asset('images/logo.png') }}" alt="JamWithMee" /></a>
        </div>
        <ul class="nav navbar-nav navbar-left">
            <li {% if app.request.attributes.get('_route') == 'home' %}class="active"{% endif %}><a href="{{ path('home') }}"><span class="glyphicon glyphicon-home"></span></a></li>
            <li {% if app.request.attributes.get('_route') == 'musicians' %}class="active"{% endif %} ><a href="{{ path('musicians') }}">Musicians</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
            {% if is_granted("ROLE_USER") %}

                <li><a href="{{ path('musician_profile', {'username': app.user.username}) }}" class="user-box-image-link img-circle" style="padding:0; margin-right: 10px">
                        <img width="30" src="{{ path('musician_avatar', { 'username': app.user.username }) }}" class="" />
                    </a>
                </li>
                <li {% if app.request.attributes.get('_route') == 'inbox' %}class="active"{% endif %}><a href="{{ path('inbox') }}" id="messages-nav"><span class="glyphicon glyphicon-envelope"></span> <span class="badge"></span></a></li>
                <li {% if app.request.attributes.get('_route') == 'fos_user_profile_edit' %}class="active"{% endif %}><a href="{{ path('fos_user_profile_edit') }}"><span class="glyphicon glyphicon-cog"></span></a></li>
                <li {% if app.request.attributes.get('_route') == 'fos_user_security_logout' %}class="active"{% endif %}><a href="{{ path('fos_user_security_logout') }}"><span class="glyphicon glyphicon-off"></span></a></li>
            {% else %}
                <li {% if app.request.attributes.get('_route') == 'fos_user_security_login' %}class="active"{% endif %}><a href="{{ path('fos_user_security_login') }}">Login</a></li>
                <li {% if app.request.attributes.get('_route') == 'fos_user_registration_register' %}class="active"{% endif %}><a href="{{ path('fos_user_registration_register') }}">Register</a></li>
            {% endif %}
        </ul>
    </div>
</div>
#}

<div class="container-fluid">
    <div class="row">

        {% if is_granted("ROLE_USER") %}
            {% if not app.user.location %}
                <div class="flash-message warning alert-warning">
                    <em>Please <a href="{{ path('fos_user_profile_edit') }}">set your location</a> in order to be able to search people around you.</em>
                </div>
            {% endif %}
        {% endif %}

        {% for flashMessage in app.session.flashbag.get('success') %}
            <div class="flash-message alert alert-success">
                <em>{{ flashMessage }}</em>
            </div>
        {% endfor %}

        {% for flashMessage in app.session.flashbag.get('error') %}
            <div class="flash-message alert alert-danger">
                <em>{{ flashMessage }}</em>
            </div>
        {% endfor %}

        {% if is_granted("ROLE_USER") and app.user.profileFulfilment != 100 %}
            <div class="progress" style="">
                <div class="progress-bar" role="progressbar" aria-valuenow="{{ app.user.profileFulfilment }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ app.user.profileFulfilment }}%;">
                    {{ app.user.profileFulfilment }}% Profile completion
                </div>
            </div>
        {% endif %}

        {% block body %}{% endblock %}
        {% block fos_user_content %}
        {% endblock fos_user_content %}
    </div>
</div>
<!-- jQuery (necessary for Bootstraps JavaScript plugins) -->
<!--<script src="https://code.jquery.com/jquery.js"></script>-->
<script src="{{ asset('/js/jquery.js') }}"></script>
<script src="{{ asset('/js/select2.min.js') }}"></script>
<!-- Include all JavaScripts, compiled by Assetic -->
<script src="{{ asset('/js/bootstrap.js') }}"></script>
<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script src="{{ asset('/js/vendor/bootstrap-typeahead.js') }}"></script>
<script src="{{ asset('/js/vendor/jquery-ui.min.js') }}"></script>
<script src="{{ asset('/js/chosen.jquery.min.js') }}"></script>
<script src="{{ asset('bundles/jamlocation/jquery.ui.addresspicker.js') }}"></script>
<script src="{{ asset('bundles/jamlocation/location.js') }}"></script>
<script src="{{ asset('js/vendor/underscore-min.js') }}"></script>
<script src="{{ asset('js/vendor/isotope.pkgd.min.js') }}"></script>
<script src="{{ asset('js/main.js') }}"></script>
<script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
<script src="{{ path('fos_js_routing_js', {"callback": "fos.Router.setData"}) }}"></script>


<script type="text/template" id="messageTemplate">
    <% _.each( rc.messages, function( m ){ %>
    <% createdAt = new Date(m.createdAt); %>
    <p data-user="<%- m.to.username %>" data-user2="<%- m.from.username %>"><strong><i><%- m.from.username %></i></strong>: <%- m.message %>
        <span class="message-time"><%- createdAt.toLocaleDateString() %> <%- createdAt.toLocaleTimeString() %></span>
    </p>
    <% }); %>
</script>

<script type="text/template" id="musicianBoxTemplate">
    <div class="col-lg-4">
        <div class="people-grid">
            <img src="{{ app.request.getBaseURL() }}/m/<%- mu.username %>/avatar" alt="<%- mu.username %>" class="img-responsive">
            <div class="people-info people-info-right">
                <h3 class="name"><a href="{{ app.request.getBaseURL() }}/m/<%- mu.username %>"><%- mu.username %></a> <br /></h3>
                <% if (mu.location) { %><div class="location"> <%- mu.location %></div><% } %>
                <ul class="tags">
                    <% _.each( mu.genres, function(v, k){ %>
                        <li><%- v %></li>
                    <% }); %>
                </ul>
                <ul class="compatibility-box">
                    <li>
                        <img src="images/icon-compatibility.png" alt="Compatibility">
                    </li>
                    <li class="compatibility">
                        <span>46%</span>
                        compatibility
                    </li>
                    <li class="last">
                        <img src="images/icon-piano.png" alt="Piano" class="icon-piano">
                    </li>
                </ul>
            </div>
        </div><!--people-grid ends-->
    </div>

</script>

{% block javascripts %}{% endblock %}

<div class="modal fade" id="imageCropModalTemplate" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="myModalLabel">Crop Photo</h4>
            </div>
            <div class="modal-body"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default btn-sm cancel-crop" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-sm btn-primary" data-dismiss="modal">Save changes</button>
            </div>
        </div>
    </div>
</div>

<script type="text/template" id="imageTemplate">
    <div class="image-holder profile-media-wall-item">
        <img src="<%- rc.url %>" />
        <div class="profile-media-image-commands">
            <a href="#" class="remove-image"><span class="glyphicon glyphicon-remove-sign"></span></a>
            <a href="#" class="set-profile-photo" data-url="<%- rc.setAvatarUrl %>">Set as avatar</a>
        </div>
    </div>
</script>


</body>
</html>
